<!--  Display the name of the current weather station -->
<h1 class="title is-2">{{station.name}}</h1>



<!-- Coordinates https://stackoverflow.com/questions/8853396/logical-operator-in-a-handlebars-js-if-conditional?  -->
{{#if station.lat}}
  <p class="mb-4 has-text-grey">Location: {{station.lat}}, {{station.lng}}</p>
{{/if}}

<!--  Weather Report Submission Form  https://developer.mozilla.org/en-US/docs/Learn_web_development/Extensions/Forms/Your_first_form -->
<div class="box">
  <h2 class="subtitle is-4">Add New Weather Report</h2>

  <!--  Form submits a POST request to /station   -->
  <form action="/station/{{station.id}}/report" method="POST">
    
    <!--  Weather Code Input  -->
    <div class="field">
      <label class="label">Weather Code</label>
      <div class="control">
        <input class="input" type="number" name="code" required />
      </div>
    </div>

    <!--  Temperature  -->
    <div class="field">
      <label class="label">Temperature (°C)</label>
      <div class="control">
        <input class="input" type="number" step="0.1" name="temperature" required />
      </div>
    </div>

    <!-- Wind Speed   -->
    <div class="field">
      <label class="label">Wind Speed (km/h)</label>
      <div class="control">
        <input class="input" type="number" step="0.1" name="windSpeed" required />
      </div>
    </div>

     <!--  Wind Direction  for compass helper -->
    <div class="field">
      <label class="label">Wind Direction</label>
      <div class="control">
        <div class="select is-fullwidth">
          <select name="windDirection" required>
            <option value="0">N</option>
            <option value="22">NNE</option>
            <option value="45">NE</option>
            <option value="67">ENE</option>
            <option value="90">E</option>
            <option value="112">ESE</option>
            <option value="135">SE</option>
            <option value="157">SSE</option>
            <option value="180">S</option>
            <option value="202">SSW</option>
            <option value="225">SW</option>
            <option value="247">WSW</option>
            <option value="270">W</option>
            <option value="292">WNW</option>
            <option value="315">NW</option>
            <option value="337">NNW</option>
          </select>
        </div>
      </div>
    </div>


    <!--  Pressure -->
    <div class="field">
      <label class="label">Pressure (hPa)</label>
      <div class="control">
        <input class="input" type="number" name="pressure" required />
      </div>
    </div>

    <!--  Submit button to add the weather report -->
    <div class="control mt-3">
      <button class="button is-link" type="submit">Add Report</button>
    </div>
  </form>
</div>

<!--  Divider between form and report list -->
<hr />
<h2 class="subtitle is-4">Reports</h2>

<!-- Display the Most Recent Report in a Summary Card -->
{{#if reports.length}} <!-- check to se if any values in reports -->
  <div class="box"> <!-- bulma box styling -->
    <h3 class="subtitle is-5">Most Recent Report</h3>
    <div class="columns">
      <div class="column">
        <!-- Temperature Box with Image -->
        <div class="box">
          <p><strong>Temperature:</strong> {{reports.[0].temperature}}°C</p> <!-- access first report in array and shows temp value -->
          <img src="/images/temp.png" alt="Temperature Icon" class="image is-48x48"><!-- Display temp icon -->
        </div>
      </div>
      <div class="column">
        <!-- Wind Speed Box with Image -->
        <div class="box">
          <p><strong>Wind Speed:</strong> {{reports.[0].windSpeed}} km/h ({{compass reports.[0].windDirection}})</p> <!-- access first report in array and shows wind value -->
         <img src="/images/wind.png" alt="Wind Icon" class="image is-48x48"> <!-- Display wind icon -->
        </div>
      </div>
      <div class="column">
        <!-- Pressure Box with Image -->
        <div class="box">
          <p><strong>Pressure:</strong> {{reports.[0].pressure}} hPa</p>
         <img src="/images/pressure.png" alt="Pressure Icon" class="image is-48x48"> <!-- Display pressure icon -->
        </div>
      </div>
    </div>
  </div>
{{else}}
  <div class="notification is-warning">No reports added yet.</div>
{{/if}}

  <!--  Display a table of all reports -->
  <table class="table is-bordered is-striped is-fullwidth">
    <thead>
      <tr>
        <th>Temperature (°C)</th>     <!-- Temperature reading -->
        <th>Wind Speed (km/h / compass)</th>    <!-- Wind speed reading -->
        <th>Pressure (hPa)</th>       <!-- Pressure reading -->
        <th> Condition</th> <!-- icon/ code -->
      </tr>
    </thead>

    <tbody>
      <!--  Loop through each report in the reports array https://handlebarsjs.com/guide/builtin-helpers.html#each-->
      {{#each reports}}
        <tr>
          
         <td>{{temperature}}</td>
          <td>{{windSpeed}} km/h ({{compass windDirection}})</td>
          <td>{{pressure}}</td>
          <td>
            {{this.code}}<br />
            <!--  Load a weather icon using my helper -->
            {{> weatherIcon }}
          </td>
        </tr>
      {{/each}}
    </tbody>
  </table>


